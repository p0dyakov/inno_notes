<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Zakhar Podyakov">
<meta name="dcterms.date" content="2025-09-17">

<title>Computer Architecture, FPGA Boards – InnoNotes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-42ed7287b56c5c583e2c2463c9cf4916.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar docked fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Computer Architecture/lec_1.html">Computer Architecture</a></li><li class="breadcrumb-item"><a href="../Computer Architecture/lec_1.html">Computer Architecture, FPGA Boards</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Academic Writing and Argumentation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Academic Writing and Argumentation/lec_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lec 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Academic Writing and Argumentation/lec_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lec 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Academic Writing and Argumentation/lec_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lec 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Academic Writing and Argumentation/lec_4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lec 4</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Academic Writing and Argumentation/lec_5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lec 5</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Academic Writing and Argumentation/lec_6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lec 6</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Analytical Geometry and Linear Algebra I</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Analytical Geometry and Linear Algebra I /lec_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lec 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Analytical Geometry and Linear Algebra I /lec_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lec 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Analytical Geometry and Linear Algebra I /lec_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lec 3</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Computer Architecture</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Computer Architecture/lec_1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Computer Architecture, FPGA Boards</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Computer Architecture/lec_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lec 2</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Discrete Mathematics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Discrete Mathematics/lec_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Truth Tables, Normal Forms (DNF &amp; CNF)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Discrete Mathematics/lec_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Logical Equivalence, Normal Forms</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Introduction to Programming</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Introduction to Programming/lec_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. Introduction to C, Compilers, and Program Structure</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Introduction to Programming/lec_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pointers, Strings, and Arrays in C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Introduction to Programming/lec_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pointers, Declarations, Preprocessing, File I/O</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Mathematical Analysis I</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Mathematical Analysis I/lec_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lec 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Mathematical Analysis I/lec_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lec 2</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Computer Architecture/lec_1.html">Computer Architecture</a></li><li class="breadcrumb-item"><a href="../Computer Architecture/lec_1.html">Computer Architecture, FPGA Boards</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Computer Architecture, FPGA Boards</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Zakhar Podyakov </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 17, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="summary" class="level4">
<h4 class="anchored" data-anchor-id="summary"><strong>1. Summary</strong></h4>
<section id="what-is-a-computer" class="level5">
<h5 class="anchored" data-anchor-id="what-is-a-computer"><strong>1.1 What is a Computer?</strong></h5>
<p>A <strong>computer</strong> is an electronic machine designed to automatically execute a sequence of arithmetic or logical operations (a program). It processes input data based on a set of instructions and produces an output. At its core, a computer operates on binary data—strings of zeros and ones—manipulating this input to generate a binary result according to a given program.</p>
<!-- DIAGRAM HERE -->
</section>
<section id="core-components-of-a-computer" class="level5">
<h5 class="anchored" data-anchor-id="core-components-of-a-computer"><strong>1.2 Core Components of a Computer</strong></h5>
<p>The fundamental structure of a modern computer, often referred to as its <strong>Computer Architecture</strong>, consists of several key components that interact to execute programs.</p>
<ul>
<li><p><strong>1.2.1 CPU (Central Processing Unit)</strong>: Often called the “brain” of the computer, the CPU is responsible for executing instructions. It is an intricate electrical circuit that performs calculations and manages the flow of information. The CPU itself is composed of smaller, specialized units:</p>
<ul>
<li>The <strong>Arithmetic-Logic Unit (ALU)</strong> performs all arithmetic (addition, subtraction) and logical (AND, OR, NOT) operations.</li>
<li>The <strong>Control Unit (CU)</strong> directs the computer’s operations. It fetches the next instruction from memory, decodes it, and coordinates the other parts of the computer to execute it.</li>
<li><strong>Registers</strong> are small, extremely fast storage locations within the CPU. They hold data that is actively being used by the CPU, such as the input arguments for an operation or its result.</li>
</ul></li>
<li><p><strong>1.2.2 System Memory (RAM)</strong>: Also known as <strong>Random Access Memory</strong>, this is the primary workspace for the computer. It stores the program instructions and data that the CPU needs to access quickly. Memory is volatile, meaning its contents are lost when the power is turned off.</p></li>
<li><p><strong>1.2.3 Storage Devices</strong>: Unlike RAM, storage devices (like Solid-State Drives or SSDs) provide long-term, non-volatile storage. They hold the operating system, applications, and user files, which are loaded into RAM as needed.</p></li>
<li><p><strong>1.2.4 Input/Output (I/O) Devices</strong>: These are peripheral components that allow the computer to interact with the outside world. Examples include keyboards, mice, monitors, printers, and network cards.</p></li>
<li><p><strong>1.2.5 Communication Bus</strong>: The bus is a set of electrical pathways that connects all the computer’s components, allowing them to exchange data. The speed of the bus is critical for overall system performance.</p></li>
</ul>
</section>
<section id="the-memory-hierarchy" class="level5">
<h5 class="anchored" data-anchor-id="the-memory-hierarchy"><strong>1.3 The Memory Hierarchy</strong></h5>
<p>Not all memory is created equal. To balance speed, cost, and capacity, computers use a <em>memory hierarchy</em>. Data moves between levels based on how frequently the CPU needs it.</p>
<ol type="1">
<li><strong>Registers (inside the CPU)</strong>: Fastest access, smallest capacity.</li>
<li><strong>CPU Cache (L1, L2, L3)</strong>: A small amount of very fast memory located on or very close to the CPU chip. It stores copies of frequently used data from the main memory to reduce the time it takes to access it. <em>L1 cache</em> is the fastest and smallest, embedded directly into each CPU core. Higher-level caches (<em>L2</em>, <em>L3</em>) are progressively larger and slower.</li>
<li><strong>System Memory (RAM)</strong>: Slower than cache but has a much larger capacity (e.g., gigabytes).</li>
<li><strong>Storage Devices (SSD)</strong>: Slowest access speed but offers the largest capacity (e.g., terabytes).</li>
</ol>
<p>This hierarchy creates a performance bottleneck known as the <em>“memory wall problem”</em>, where the CPU is often idle while waiting for data to arrive from slower levels of memory. Efficiently managing this hierarchy is a key challenge in computer architecture.</p>
<!-- DIAGRAM HERE -->
</section>
<section id="processors-vs.-fpgas" class="level5">
<h5 class="anchored" data-anchor-id="processors-vs.-fpgas"><strong>1.4 Processors vs.&nbsp;FPGAs</strong></h5>
<p>A standard <strong>CPU</strong> is a <em>general-purpose processor</em>. Its functionality is fixed at the time of manufacturing. It supports a specific, limited set of instructions (its <strong>instruction set</strong>), and this functionality cannot be changed or extended.</p>
<p>An <strong>FPGA (Field-Programmable Gate Array)</strong> is fundamentally different. It is not a processor, but rather an integrated circuit containing a matrix of configurable logic blocks and programmable interconnects.</p>
<ul>
<li><strong>1.4.1 Key Differences</strong>:
<ul>
<li><strong>Programmability</strong>: A CPU executes software instructions, but its underlying hardware is fixed. An FPGA’s hardware itself can be reprogrammed many times to perform custom tasks.</li>
<li><strong>Instruction Set</strong>: A CPU has a fixed instruction set. With an FPGA, you design the logic circuits yourself, effectively creating a custom set of instructions tailored precisely to your needs.</li>
<li><strong>Speed &amp; Efficiency</strong>: For general tasks, a CPU is efficient. For highly specific, parallelizable tasks (like real-time signal processing), a custom circuit on an FPGA can be significantly faster because the hardware is built for that one job.</li>
<li><strong>Cost and Power</strong>: FPGAs are generally more expensive and consume more power than general-purpose processors.</li>
</ul></li>
<li><strong>1.4.2 Use Cases for FPGAs</strong>: FPGAs are often used for prototyping and testing new processor designs before committing to expensive mass manufacturing. They are also ideal for tasks that require massive parallelism and low latency, such as in telecommunications, scientific instruments, and high-frequency trading.</li>
</ul>
</section>
<section id="fpga-programming-and-boards" class="level5">
<h5 class="anchored" data-anchor-id="fpga-programming-and-boards"><strong>1.5 FPGA Programming and Boards</strong></h5>
<p>FPGAs are programmed using a <strong>Hardware Description Language (HDL)</strong>, such as <strong>Verilog</strong> or <strong>VHDL</strong>. These are not traditional programming languages; instead, they describe the structure and behavior of digital logic circuits. Software like <strong>Intel Quartus Prime</strong> is used to synthesize this HDL code into a configuration file that is then loaded onto the FPGA to implement the desired hardware design.</p>
<p>Educational FPGA boards, like the <strong>DE10-Lite</strong>, come equipped with an FPGA chip and various I/O devices (LEDs, push buttons, switches, displays, sensors) that allow students to design and test real-world digital circuits.</p>
</section>
</section>
<section id="definitions" class="level4">
<h4 class="anchored" data-anchor-id="definitions"><strong>2. Definitions</strong></h4>
<ul>
<li><strong>Computer</strong>: An electronic device that processes data by executing a sequence of instructions defined in a program.</li>
<li><strong>Computer Architecture</strong>: The fundamental design and operational structure of a computer system, detailing how its hardware components (CPU, memory, I/O) are organized and interact.</li>
<li><strong>CPU (Central Processing Unit)</strong>: The primary component of a computer that executes program instructions and performs arithmetic, logic, and control operations.</li>
<li><strong>ALU (Arithmetic-Logic Unit)</strong>: A digital circuit within the CPU that performs integer arithmetic (add, subtract) and bitwise logic operations (AND, OR, NOT).</li>
<li><strong>CU (Control Unit)</strong>: The component of the CPU that directs the operation of the processor by interpreting instructions and generating control signals for other components.</li>
<li><strong>Register</strong>: A small, high-speed storage location directly within the CPU used to hold data and instructions temporarily during processing.</li>
<li><strong>System Memory (RAM)</strong>: Volatile computer memory that stores data and machine code currently being used. It allows for fast read and write access.</li>
<li><strong>CPU Cache</strong>: A small, fast volatile memory, located closer to the CPU core, that stores copies of frequently used data from main memory to improve access times.</li>
<li><strong>Memory Hierarchy</strong>: A structure that uses a hierarchy of memory and storage devices with different performance characteristics to optimize data access and balance cost, speed, and capacity.</li>
<li><strong>FPGA (Field-Programmable Gate Array)</strong>: An integrated circuit that can be configured by a user after manufacturing, allowing the hardware logic itself to be reprogrammed.</li>
<li><strong>Verilog HDL</strong>: A hardware description language used to model electronic systems, most commonly for designing and verifying digital circuits at the register-transfer level of abstraction.</li>
<li><strong>Instruction Set</strong>: The specific set of commands that a particular CPU can recognize and execute, defined by the processor’s architecture.</li>
</ul>
</section>
<section id="mistakes" class="level4">
<h4 class="anchored" data-anchor-id="mistakes"><strong>3. Mistakes</strong></h4>
<ul>
<li><strong>Confusing an FPGA with a CPU</strong>: Treating an FPGA as just a “faster CPU.” <strong>Why it’s wrong:</strong> They are fundamentally different. A CPU is a fixed-function processor that runs software instructions, while an FPGA is a blank slate of configurable hardware logic. An FPGA is not inherently faster; it’s only faster for tasks that can be efficiently implemented in custom, parallel hardware.</li>
<li><strong>Assuming FPGAs are always the better choice for performance</strong>: Believing an FPGA will outperform a CPU on any task. <strong>Why it’s wrong:</strong> For general-purpose computing (like running an operating system or a web browser), CPUs are far more efficient due to their specialized architecture and rich instruction sets. FPGAs excel only in very specific, often parallel, applications.</li>
<li><strong>Ignoring the Memory Hierarchy</strong>: Writing code without considering how data moves between the CPU cache and main memory. <strong>Why it’s wrong:</strong> The “memory wall”—the large speed gap between the CPU and RAM—is a primary performance bottleneck. Programs that access memory randomly and without locality of reference will perform poorly, as the CPU will constantly stall while waiting for data.</li>
<li><strong>Treating Verilog like a software programming language</strong>: Writing Verilog code sequentially, as one would in Python or C, and expecting it to execute line by line. <strong>Why it’s wrong:</strong> Verilog is a hardware description language. It describes physical circuits that operate in parallel. A misunderstanding of this core concept leads to designs that don’t synthesize into working hardware or behave unexpectedly.</li>
<li><strong>Believing a processor’s functionality can be changed with software</strong>: Thinking you can add new hardware-level instructions to a CPU through a software update. <strong>Why it’s wrong:</strong> A CPU’s instruction set is physically etched into its silicon circuits during manufacturing and cannot be altered. While software can emulate new functionality, the underlying hardware capabilities remain fixed.</li>
</ul>
</section>
<section id="examples" class="level4">
<h4 class="anchored" data-anchor-id="examples"><strong>4. Examples</strong></h4>
<section id="simple-logic-in-verilog" class="level5">
<h5 class="anchored" data-anchor-id="simple-logic-in-verilog"><strong>4.1 Simple Logic in Verilog</strong></h5>
<p><strong>Question:</strong> Write a Verilog module that implements a simple AND gate. It should take two single-bit inputs, <code>a</code> and <code>b</code>, and produce one single-bit output, <code>y</code>.</p>
<details>
<summary>
Click to see the solution
</summary>
<ol type="1">
<li><strong>Define the module:</strong> Start by declaring a module with a name (e.g., <code>simple_and</code>) and list its input and output ports. <code>verilog     module simple_and(         input  logic a,         input  logic b,         output logic y     );</code></li>
<li><strong>Assign the logic:</strong> Use a continuous <code>assign</code> statement to describe the relationship between the inputs and the output. The <code>&amp;</code> operator performs a bitwise AND operation. <code>verilog     assign y = a &amp; b;</code></li>
<li><strong>End the module:</strong> Close the module definition. <code>verilog     endmodule</code></li>
</ol>
<p><strong>Answer:</strong> The complete Verilog module is:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode verilog code-with-copy"><code class="sourceCode verilog"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">module</span> simple_and<span class="op">(</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">input</span>  logic a<span class="op">,</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">input</span>  logic b<span class="op">,</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">output</span> logic y</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="op">);</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">assign</span> y <span class="op">=</span> a <span class="op">&amp;</span> b<span class="op">;</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="kw">endmodule</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</section>
<section id="controlling-an-led-with-a-switch" class="level5">
<h5 class="anchored" data-anchor-id="controlling-an-led-with-a-switch"><strong>4.2 Controlling an LED with a Switch</strong></h5>
<p><strong>Question:</strong> On an FPGA board like the DE10-Lite, you have a switch (<code>SW0</code>) and an LED (<code>LED0</code>). Write a Verilog module to make the LED turn on when the switch is on, and turn off when the switch is off.</p>
<details>
<summary>
Click to see the solution
</summary>
<ol type="1">
<li><strong>Define the module and ports:</strong> Create a module named <code>led_control</code> with one input for the switch and one output for the LED. <code>verilog     module led_control(         input  logic SW0,         output logic LED0     );</code></li>
<li><strong>Connect the switch to the LED:</strong> The simplest way to achieve this is to directly connect the input to the output. An <code>assign</code> statement creates a “wire” between the two. <code>verilog     assign LED0 = SW0;</code></li>
<li><strong>End the module:</strong> Close the module definition. <code>verilog     endmodule</code> <strong>Answer:</strong> The Verilog module directly connects the switch’s state to the LED’s state:</li>
</ol>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode verilog code-with-copy"><code class="sourceCode verilog"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">module</span> led_control<span class="op">(</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">input</span>  logic SW0<span class="op">,</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">output</span> logic LED0</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="op">);</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="kw">assign</span> LED0 <span class="op">=</span> SW0<span class="op">;</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="kw">endmodule</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</section>
<section id="cpu-vs.-fpga-application-choice" class="level5">
<h5 class="anchored" data-anchor-id="cpu-vs.-fpga-application-choice"><strong>4.3 CPU vs.&nbsp;FPGA Application Choice</strong></h5>
<p><strong>Question:</strong> You are designing a system for real-time video encoding that needs to process 4K video at 60 frames per second with very low latency. Would a general-purpose CPU or an FPGA be a better choice for the core processing unit? Explain why.</p>
<details>
<summary>
Click to see the solution
</summary>
<ol type="1">
<li><strong>Analyze the task requirements:</strong> The task involves processing a massive, continuous stream of data (4K video) with strict timing constraints (60 fps, low latency). The operations (e.g., color space conversion, compression algorithms) are highly repetitive and can be broken down into many small, parallel steps.</li>
<li><strong>Evaluate the CPU’s suitability:</strong> A CPU would process the video frames using software. While powerful, it executes instructions sequentially (even with multiple cores) and has overhead from the operating system. Achieving consistent low latency for every single frame would be extremely challenging.</li>
<li><strong>Evaluate the FPGA’s suitability:</strong> An FPGA can be configured to have a dedicated hardware pipeline for video processing. Multiple stages of the encoding algorithm can run simultaneously on different parts of the chip for different pixels or frames. This massive parallelism is ideal for video streams. Because it’s a dedicated hardware solution, it avoids OS overhead and can guarantee consistent, low-latency processing. <strong>Answer:</strong> An <strong>FPGA</strong> is the better choice. <strong>Why:</strong> Video encoding is a highly parallel task. An FPGA allows for the creation of a custom hardware pipeline where many calculations happen simultaneously, which is far more efficient and provides the low, predictable latency required for real-time processing, something a general-purpose CPU struggling with OS and other overheads cannot guarantee.</li>
</ol>
</details>
</section>
<section id="memory-hierarchy-access" class="level5">
<h5 class="anchored" data-anchor-id="memory-hierarchy-access"><strong>4.4 Memory Hierarchy Access</strong></h5>
<p><strong>Question:</strong> A program is executing a <code>for</code> loop that repeatedly adds two numbers. The machine code instruction for the addition operation is currently being executed by the CPU. In which level of the memory hierarchy would you most likely find this instruction?</p>
<details>
<summary>
Click to see the solution
</summary>
<ol type="1">
<li><strong>Consider the CPU’s immediate needs:</strong> The CPU can only execute instructions that are physically inside it.</li>
<li><strong>Recall the fastest memory level:</strong> The fastest and closest memory to the ALU and CU are the registers. The Control Unit fetches instructions from memory into a special-purpose register (often called the Instruction Register) just before decoding and execution.</li>
<li><strong>Consider the role of cache:</strong> Since the instruction is part of a loop, it’s being used repeatedly. Therefore, it is almost certain to have been copied from the slower main memory (RAM) into the much faster L1 instruction cache for quick access on subsequent loop iterations.</li>
<li><strong>Combine the points:</strong> The instruction must be in a register to be executed. Given it’s in a loop, it would also reside in the L1 cache to avoid fetching it from slow RAM every time. The most immediate location is a register. <strong>Answer:</strong> The instruction would be found in a <strong>CPU register</strong> (specifically, the instruction register) at the moment of execution. A copy of it would also reside in the <strong>L1 cache</strong> for fast re-access during the next iteration of the loop.</li>
</ol>
</details>
</section>
<section id="to-1-multiplexer-in-verilog" class="level5">
<h5 class="anchored" data-anchor-id="to-1-multiplexer-in-verilog"><strong>4.5 2-to-1 Multiplexer in Verilog</strong></h5>
<p><strong>Question:</strong> A 2-to-1 multiplexer (MUX) is a circuit that selects one of two inputs (<code>a</code> or <code>b</code>) to pass to the output (<code>y</code>) based on a selector signal (<code>sel</code>). If <code>sel</code> is 0, <code>y</code> should be <code>a</code>. If <code>sel</code> is 1, <code>y</code> should be <code>b</code>. Implement this in a Verilog module.</p>
<details>
<summary>
Click to see the solution
</summary>
<ol type="1">
<li><strong>Define the module and its ports:</strong> The module requires three inputs (<code>a</code>, <code>b</code>, <code>sel</code>) and one output (<code>y</code>). <code>verilog     module mux_2_to_1(         input  logic a,         input  logic b,         input  logic sel,         output logic y     );</code></li>
<li><strong>Implement the selection logic:</strong> A conditional <code>assign</code> statement using the ternary operator (<code>? :</code>) is a concise way to model this. The structure is <code>condition ? value_if_true : value_if_false</code>. <code>verilog     assign y = (sel == 1) ? b : a;</code> This line reads as: “Assign <code>y</code> the value of <code>b</code> if <code>sel</code> is 1; otherwise, assign it the value of <code>a</code>.”</li>
<li><strong>End the module:</strong> Close the module definition. <code>verilog     endmodule</code> <strong>Answer:</strong> The complete Verilog module for a 2-to-1 MUX is:</li>
</ol>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode verilog code-with-copy"><code class="sourceCode verilog"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">module</span> mux_2_to_1<span class="op">(</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">input</span>  logic a<span class="op">,</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">input</span>  logic b<span class="op">,</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">input</span>  logic sel<span class="op">,</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">output</span> logic y</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="op">);</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="kw">assign</span> y <span class="op">=</span> sel <span class="op">?</span> b <span class="op">:</span> a<span class="op">;</span> <span class="co">// A more compact way of writing (sel == 1)</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="kw">endmodule</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</section>
<section id="processor-instruction-set-limitation" class="level5">
<h5 class="anchored" data-anchor-id="processor-instruction-set-limitation"><strong>4.6 Processor Instruction Set Limitation</strong></h5>
<p><strong>Question:</strong> Imagine a very simple processor whose instruction set only contains <code>ADD</code>, <code>SUBTRACT</code>, and <code>STORE</code>. You need to perform a multiplication, for example, 5 * 3. How could you accomplish this using only the available instructions?</p>
<details>
<summary>
Click to see the solution
</summary>
<ol type="1">
<li><strong>Understand the core concept of multiplication:</strong> Multiplication is repeated addition. For example, 5 * 3 is the same as 5 + 5 + 5.</li>
<li><strong>Formulate an algorithm using available instructions:</strong>
<ul>
<li>Initialize a result variable (in a register, let’s call it <code>R1</code>) to 0.</li>
<li>Use the <code>ADD</code> instruction to add 5 to <code>R1</code>.</li>
<li>Use the <code>ADD</code> instruction again to add 5 to <code>R1</code>. <code>R1</code> now holds 10.</li>
<li>Use the <code>ADD</code> instruction a third time to add 5 to <code>R1</code>. <code>R1</code> now holds 15.</li>
<li>Use the <code>STORE</code> instruction to save the value from <code>R1</code> to a memory location.</li>
</ul></li>
<li><strong>Structure the process:</strong> This would be implemented as a software loop. The program would use the <code>ADD</code> instruction three times. <strong>Answer:</strong> You can perform multiplication by implementing it as a series of additions. To calculate 5 * 3, you would write a short program that uses a loop to execute the <code>ADD 5</code> instruction three times, accumulating the result in a register.</li>
</ol>
</details>
</section>
<section id="identifying-fpga-board-components" class="level5">
<h5 class="anchored" data-anchor-id="identifying-fpga-board-components"><strong>4.7 Identifying FPGA Board Components</strong></h5>
<p><strong>Question:</strong> You are looking at a DE10-Lite FPGA board. You see a large, square chip in the center labeled “MAX 10”. What is the function of this component?</p>
<details>
<summary>
Click to see the solution
</summary>
<ol type="1">
<li><strong>Analyze the component’s description:</strong> The chip is large, centrally located, and has a specific model name (“MAX 10”).</li>
<li><strong>Recall the purpose of an FPGA board:</strong> The primary purpose of an FPGA development board is to provide a platform for programming and testing an FPGA.</li>
<li><strong>Connect the information:</strong> The central, most prominent chip on an FPGA board is almost always the FPGA itself. The “MAX 10” is a product family of FPGAs made by Altera (now Intel). <strong>Answer:</strong> The chip labeled “MAX 10” is the <strong>FPGA (Field-Programmable Gate Array)</strong> itself. It is the main component that you program with your hardware design using a language like Verilog.</li>
</ol>
</details>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>